---
title: "analyse_descriptive_data2"
author: "laurie dussere"
date: "29/03/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

````{r}
library(ggplot2)
library(corrplot)
library("xlsx")
library(FactoMineR)
library(factoextra)
library(cowplot)
library("NbClust")
library(readxl)
library(missForest)
````

```{r}
##second jeu de données plus complet
data2= read_excel("tableau_complet.xlsx")
#data2=missForest(data2[,-1])
#summary(data2)
head(data2)

data2=transform(data2,GPD =as.numeric(GPD),Gender_Gap =as.numeric(Gender_Gap),Ethnic =as.numeric(Ethnic),Linguistic =as.numeric(Linguistic),Religious =as.numeric(Religious),Science_and_Technology =as.numeric(Science_and_Technology),Culture=as.numeric(Culture),International_Peace_and_Security=as.numeric(International_Peace_and_Security),World_Order=as.numeric(World_Order),Planet_and_Climate=as.numeric(Planet_and_Climate),Prosperity_and_Equality=as.numeric(Prosperity_and_Equality),Health_and_Well_being=as.numeric(Health_and_Well_being),Emigrants=as.numeric(Emigrants),Suicide_Both_sexes=as.numeric(Suicide_Both_sexes),Suicide_Men=as.numeric(Suicide_Men),Suicide_Women=as.numeric(Suicide_Women),National_power=as.numeric(National_power),Population=as.numeric(Population),HDI=as.numeric(HDI),Corruption=as.numeric(Corruption),Terrorism=as.numeric(Terrorism),Poverty_pct=as.numeric(Poverty_pct))

rownames(data2)<-data2$Countries

#rownames(data2)
head(data2)

data2=missForest(data2[,-1])$ximp #on fait un miss forest pour compléter les données manquantes et ne pas avoir de problèmes de NA dans la suite de l'analyse.


summary(data2)
head(data2)
class(data2)
```


```{r}
class(data2)
```

```{r}
#head(data2)
#class(data2)
#data2=as.data.frame(data2)
#class(data2)
data2=scale(data2)
boxplot(data2)
```

```{r}
par(mfrow=c(3,2))
hist(data2[,1],breaks = "FD",freq =TRUE, main = "GPD",xlab = "GPD",ylab = "effectifs")
hist(data2[,2],main="Histogram of Gender Gap")
hist(data2[,3],breaks = "FD",freq=TRUE, main ="Ethnic")
hist(data2[,4],breaks = "FD",freq=TRUE, main ="Linguiistic")
hist(data2[,5],breaks = "FD",freq=TRUE, main ="Religious")
hist(data2[,6],breaks = "FD",freq=TRUE, main ="Science_and_Technology")
```


### Linguistic et Ethnic

```{r}
#Process et Lib_Civiles
data2=as.data.frame(data2)
plot(Linguistic ~ Ethnic,data=data2)
abline(lm(Linguistic ~ Ethnic, data=data2),col="red")
```

Données très éparpillées on ne voit pas vraiment la corrélation linéaire entre les variables.

```{r}
#Process et Lib_Civiles
plot(Culture ~ Science_and_Technology,data=data2)
abline(lm(Culture ~ Science_and_Technology, data=data2),col="red")
```
On voit une tendance linéaire se démarquer.

```{r}
#Process et Lib_Civiles
plot(National_power ~ Population,data=data2, xlim=c(0,2), ylim=c(0,2))
abline(lm(National_power ~ Population, data=data2),col="red")

```

```{r}
#Process et Lib_Civiles
plot(Corruption ~ HDI,data=data2)
abline(lm(Corruption ~ HDI, data=data2),col="red")
```

On voit bien la relation linéaire qui relie ces 2 variables.


#ACP

```{r fig.height=12}
M=cor(data2[,-14]) #corrplot en supprimant la moyenne des suicides
corrplot.mixed(M,upper="ellipse",tl.pos="lt")
#method="ellipse",type="upper"
```

Très forte corrélation entre Suicide_Men et Suicide_Both (0.93). Un peu moins forte entre Suicide Women et Both (0.8)

Forte corrélation positive entre :
Linguistic et Ethnic (0.68)
Culture et Science and Technology (0.71)
National Power et Population (0.82)
Corruption et HDI (human dev index) (0.76)

L'étude des corrélations entre les suicides ne me semble pas apporter quelque chose d'important. Nous allons regarder les autres corrélations.




